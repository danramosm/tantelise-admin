
<div class="fondo-negro animated fadeIn " [ngClass]="editarModalServiceService.oculto" >

  <div class="modal" tabindex="-1" role="dialog" style="display:block">
    <div class="modal-dialog  modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Editar producto: {{producto?.nombreProducto}}</h5>

          <button type="button" class="close" (click)="cerrarModal()" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>

        </div>

        <div class="modal-body">

          <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item">
              <a class="nav-link active" id="Producto-tab" data-toggle="tab" href="#Producto" role="tab" aria-controls="Producto" aria-selected="true">Principal</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" id="Detalles-tab" data-toggle="tab" href="#Detalles" role="tab" aria-controls="Detalles" aria-selected="false">Detalle precios</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" id="Servicios adicionales-tab" data-toggle="tab" href="#Servicios adicionales" role="tab" aria-controls="Servicios adicionales" aria-selected="false">Servicios adicionales</a>
            </li>
            

          </ul>
          <div class="tab-content py-4" id="myTabContent">

            <div class="tab-pane fade show active" id="Producto" role="tabpanel" aria-labelledby="Producto-tab">
                <form>
                    <div class="form-group row">
                        <label for="staticEmail" class="col-sm-2 col-form-label">ID Producto</label>
                        <div class="col-sm-10">
                          <input type="text" readonly class="form-control-plaintext" id="staticEmail" [value]="producto?.id" />
                        </div>
                      </div>

                      <div class="form-group row">
                          <label for="staticEmail" class="col-sm-2 col-form-label">Imágen portada</label>
                          <div class="col-sm-10">
                            <img [src]="producto?.imagenPortada" class="img-fluid img-thumbnail" />
                          </div>
                        </div>

                      <div class="form-group row">
                          <label for="staticEmail" class="col-sm-2 col-form-label">Ingreso</label>
                          <div class="col-sm-10">
                            <input type="text" readonly class="form-control-plaintext" id="staticEmail" [value]="producto?.fechaIngreso" />
                          </div>
                        </div>

                      <div class="form-group row">
                          <label for="inputEmail3" class="col-sm-2 col-form-label">Nombre del producto</label>
                          <div class="col-sm-10">
                            <input type="text" class="form-control" name="producto.nombreProducto" [ngModel]="producto?.nombreProducto"  (ngModelChange)="producto.nombreProducto=$event" [value]="producto?.nombreProducto" >
                          </div>
                        </div>


                        <div class="form-group row">
                            <label for="inputEmail3" class="col-sm-2 col-form-label">Descripción</label>
                            <div class="col-sm-10">
                                <textarea class="form-control" aria-label="With textarea" name="producto.descripcionProducto" [ngModel]="producto?.descripcionProducto" (ngModelChange)="producto.descripcionProducto=$event" [value]="producto?.descripcionProducto" ></textarea>
                            </div>
                          </div>

                          <div class="form-group row">
                              <label for="inputEmail3" class="col-sm-2 col-form-label">Categoría</label>
                              <div class="col-sm-10">
                                  <select class="custom-select" name="producto.categoriaProducto" [ngModel]="producto?.categoriaProducto" (ngModelChange)="producto.categoriaProducto=$event" >
                                      <option *ngFor="let categoria of categoriaLista" [value]="categoria?.nombreCategoria" >{{categoria.nombreCategoria}}</option>
                                    </select>
                              </div>
                          </div>

                          <div class="form-group row">
                              <label for="inputEmail3" class="col-sm-2 col-form-label">Estado</label>
                              <div class="col-sm-10">
                                  <select class="custom-select"  name="producto.estado" [ngModel]="producto?.estado" (ngModelChange)="producto.estado=$event" >
                                      <option *ngFor="let estado of estadoProductos" [value]='estado?.estado'>{{estado?.estado}}</option>
                                    </select>
                              </div>
                          </div>


                  </form>
            </div>


            <!-- Da error (ver consola) por que se está accediendo a detalleProducto, pero como estoy haciendo un fix de instanciar un producto en nulo no se encuentra
            esa propiedad, se debe buscar la forma de que no se instancie.... ahí está la weaaa era con el ? safe navigator operator-->
            <div class="tab-pane fade" id="Detalles" role="tabpanel" aria-labelledby="Detalles-tab">
              Formatos de venta:
              <form>
                <div class="div" *ngFor="let unidad of producto?.detalleProducto?.unidadVenta; let i=index" class="border-bottom mb-4">

                    <div class="form-group row">
                        <label for="inputEmail3" class="col-sm-2 col-form-label"><strong>Unidad de venta {{ i+1 }}</strong></label>
                        <div class="col-sm-10">
                          <input type="text" class="form-control" [name]="unidad.unidad+i" [ngModel]="unidad?.unidad"  (ngModelChange)="unidad.unidad=$event" [value]="unidad?.unidad" >
                        </div>
                      </div>

                      <div class="form-group row">
                          <label for="inputEmail3" class="col-sm-2 col-form-label">Precio por {{unidad?.unidad}}</label>
                          <div class="col-sm-10">
                            <input type="text" class="form-control" [name]="unidad.precio+unidad.unidad+i" [ngModel]="unidad?.precio"  (ngModelChange)="unidad.precio=$event" [value]="unidad?.precio" >
                          </div>
                        </div>
                </div>
              </form>

              <button type="button" class="btn btn-primary" (click)="agregarPrecio()">agregarPrecio</button>


            </div>
            <div class="tab-pane fade" id="Servicios adicionales" role="tabpanel" aria-labelledby="Servicios adicionales-tab"> 
              Servicios adicionales activados
                <form>
                    <div class="form-check" *ngFor="let servicio of servicioAdicionalLista; let i=index">
                        <input class="form-check-input" type="checkbox" [id]="producto?.id + servicio.id" [checked]="producto?.detalleProducto?.servicioAdicional[i]?.activado"  [name]="producto?.id + servicio.id" [value]="servicio.nombre"  [ngModel]="producto?.detalleProducto?.servicioAdicional[i]?.activado" (ngModelChange)="servicio.activado = $event; producto?.detalleProducto?.servicioAdicional[i] = servicio; ">
                        <label class="form-check-label" [for]="producto?.id + servicio.id ">
                          {{servicio.nombre}}
                        </label>
                        <br/>
                      </div>
                </form> 

            </div>

          </div>



        </div>
        <div class="modal-footer">
        
          <strong>Fecha última modificación: </strong>
          <input type="text" readonly class="form-control-plaintext" id="staticEmail" [value]="producto?.fechaModificacion" />
          
          <button type="button" class="btn btn-primary" (click)="guardarProducto(producto)">Guardar</button>
          <button type="button" class="btn btn-secondary" (click)="cerrarModal()">Cerrar</button>
        </div>
      </div>
    </div>
  </div>

</div>